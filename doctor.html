<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Doctors - Global Hospital</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="form-card">
    <h2>Add Doctor</h2>
    <input type="text" id="doctorName" placeholder="Doctor Name" />
    <input type="text" id="specialization" placeholder="Specialization" />
    <input type="text" id="timing" placeholder="Available Time" />
    <button id="addDoctorBtn">Add Doctor</button>
    <ul id="doctorList"></ul>
    <br>
    <a href="view_appointments.html" class="back-button">→ View Appointments</a>
  </div>

  <!-- ✅ Script placed LAST, after HTML -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyALDkSWZRuKcG7Gfn9w1agvnWtma3qmPVc",
      authDomain: "hmm1-84404.firebaseapp.com",
      projectId: "hmm1-84404",
      storageBucket: "hmm1-84404.appspot.com",
      messagingSenderId: "380112403059",
      appId: "1:380112403059:web:7879897802d5ca46e4c806"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    document.getElementById('addDoctorBtn').addEventListener('click', async () => {
      const name = document.getElementById("doctorName").value.trim();
      const spec = document.getElementById("specialization").value.trim();
      const time = document.getElementById("timing").value.trim();

      if (!name || !spec || !time) {
        alert("Please fill all fields.");
        return;
      }

      try {
        await addDoc(collection(db, "doctors"), { name, spec, time });
        alert("✅ Doctor added!");
        loadDoctors();
        document.getElementById("doctorName").value = '';
        document.getElementById("specialization").value = '';
        document.getElementById("timing").value = '';
      } catch (e) {
        console.error("Error adding doctor:", e);
        alert("❌ Failed to add doctor.");
      }
    });

    async function loadDoctors() {
      try {
        const querySnapshot = await getDocs(collection(db, "doctors"));
        const list = document.getElementById("doctorList");
        list.innerHTML = "";
        querySnapshot.forEach(docSnap => {
          const data = docSnap.data();
          const li = document.createElement("li");
          li.innerHTML = `
            ${data.name} - ${data.spec} (${data.time})
          `;
          list.appendChild(li);
        });
      } catch (e) {
        console.error("Error loading doctors:", e);
      }
    }

    // Load doctors on page load
    loadDoctors();
  </script>
</body>
</html>
